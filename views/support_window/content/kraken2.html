<h4 id="3-2-4-kraken2-panel-de-clasificaci-n-taxon-mica">3.2.4 Kraken2 — Panel de clasificación taxonómica</h4>
<h3 id="-qu-es-este-panel-">¿Qué es este panel?</h3>
<p>El módulo <strong>Kraken2</strong> ejecuta la clasificación taxonómica de lecturas FASTQ utilizando
    k-mers/minimizers y una base de datos de referencia. Desde este panel seleccionas el/los archivos a clasificar,
    configuras los parámetros (threads, umbrales de confianza, uso de memoria, etc.), lanzas la clasificación y
    revisas los archivos de salida y el reporte resumido. Kraken2 es una herramienta rápida y configurable para
    obtener asignaciones taxonómicas preliminares.</p>
<hr>
<h3 id="vista-general-del-panel">Vista general del panel</h3>
<p>Elementos principales que encontrarás:</p>
<ul>
    <li>
        <p><strong>Selector de archivo(s)</strong> (zona superior/izquierda): selecciona uno o varios FASTQ desde el
            workspace; en modo PE asegúrate de seleccionar ambos mates.</p>
    </li>
    <li>
        <p><strong>Selector de base de datos</strong> (debajo del selector de archivo o contiguo): elige la DB de
            Kraken2 instalada (p. ej. <code>gtdb_r89_54k_kraken2_01gb</code>).</p>
    </li>
    <li>
        <p><strong>Botón / modal Gestor de bases de datos</strong>: abre una ventana donde puedes añadir enlaces de
            descarga, instalar o borrar DB (útil cuando necesitas bases nuevas).</p>
    </li>
    <li>
        <p><strong>Botones superiores (derecha)</strong>: (1) <strong>Manual</strong> (abre la Support Window), (2)
            <strong>Ver comando</strong> (modal con la invocación que se ejecutará), (3) <strong>Guardar
                configuración</strong> (estrella), (4) <strong>Gestor de DB</strong> (ícono de bases).
        </p>
    </li>
    <li>
        <p><strong>Página de opciones</strong>: controles para <code>threads</code>, <code>quick</code>,
            <code>memory mapping</code>, <code>confidence</code>, <code>minimum hit groups</code>,
            <code>minimum base quality</code>.
        </p>
    </li>
    <li>
        <p><strong>Panel de reportes / resultados anteriores</strong>: accesos a salidas previas (abrir carpeta,
            borrar).</p>
    </li>
    <li>
        <p><strong>Botones de acción</strong>: <strong>Atrás</strong> y <strong>Taxonomizar / Ejecutar</strong>.</p>
    </li>
</ul>
<h3 id="ejemplos-visuales">Ejemplos visuales</h3>
<p><strong>Figura — Selector DB / Gestor de DB (modal).</strong></p>
<br>
<img src=":/manual/main_window_kraken_panel_database.png" alt="" width="500">
<br>
<p><em>Gestor de bases de datos: añadir, descargar e instalar bases de referencia para Kraken2</em>
</p>
<p><strong>Figura — Selector de archivo y selector de base de datos (Página 1).</strong></p>
<br>
<img src=":/manual/main_window_kraken_panel_files_page.png" alt="" width="500">
<br>
<p><em>Selección de archivo(s) de entrada y base de datos de referencia.</em>
</p>
<p><strong>Figura — Opciones de Kraken2 (Página 2).</strong></p>
<br>
<img src=":/manual/main_window_kraken_panel_options_page.png" alt="" width="500">
<br>
<p><em>Página de opciones: ajuste de Threads, Quick, Memory Mapping, Confidence, Minimum Hit Groups y Minimum Base
        Quality.</em>
</p>
<p><strong>Figura — Modal “Ver comando”.</strong></p>
<br>
<img src=":/manual/main_window_kraken_panel_command.png" alt="" width="500">
<br>
<p><em>Ventana modal que muestra la invocación exacta (<code>wsl kraken2 ...</code>) que se ejecutará.</em>
</p>
<h3 id="flujo-de-uso-paso-a-paso-">Flujo de uso (paso a paso)</h3>
<ol>
    <li>
        <p><strong>Seleccionar archivo(s):</strong> haga clic en el selector y elija el/los FASTQ a clasificar. En PE
            seleccione ambos mates.</p>
    </li>
    <li>
        <p><strong>Seleccionar base de datos:</strong> en el control de DB elija una base instalada. Si falta, abra el
            <strong>Gestor de bases de datos</strong> y descargue/instale la DB necesaria. (ver Figura 1).
        </p>
    </li>
    <li>
        <p><strong>Siguiente → Opciones:</strong> configure <code>threads</code>, active/desactive <code>quick</code> o
            <code>memory mapping</code>, y ajuste <code>confidence</code>, <code>minimum hit groups</code> y
            <code>minimum base quality</code>.
        </p>
    </li>
    <li>
        <p><strong>(Opcional) Ver comando:</strong> pulse <strong>Ver comando</strong> para ver/copiar la invocación
            <code>kraken2</code> (la aplicación puede usar <code>wsl kraken2 ...</code> — revise rutas).
        </p>
    </li>
    <li>
        <p><strong>Ejecutar / Taxonomizar:</strong> pulse <strong>Taxonomizar</strong>; se mostrará progreso. Al
            terminar se generarán archivos <code>output</code> (asignaciones por read) y <code>report</code> (resumen
            por taxa).</p>
    </li>
    <li>
        <p><strong>Visualizar:</strong> abra el <code>report</code> o use Krona para visualizar resultados
            interactivos.</p>
    </li>
</ol>
<h3 id="comportamientos-y-estados-importantes">Comportamientos y estados importantes</h3>
<ul>
    <li>
        <p><strong>Gestor de DB:</strong> la descarga/instalación puede requerir mucho espacio y tiempo. El modal
            muestra DB instaladas y pendientes — usa el botón de descarga para instalar. (ver Figura 1).</p>
    </li>
    <li>
        <p><strong>Ejecución bajo WSL:</strong> la invocación puede mostrarse prefijada con <code>wsl</code> (p. ej.
            <code>wsl kraken2 --db /mnt/c/...</code>), como en la figura &quot;ver comando&quot;.
        </p>
    </li>
    <li>
        <p><strong>Selección PE/SE:</strong> la interfaz indicará si faltan mates en PE; no ejecutes sin verificar
            pares.</p>
    </li>
    <li>
        <p><strong>Salida para Krona:</strong> normalmente exportas el <code>report</code> para convertirlo a Krona si
            quieres visualización interactiva.</p>
    </li>
</ul>
<h3 id="par-metros-descripci-n-detallada-y-recomendaciones">Parámetros — descripción detallada y recomendaciones</h3>
<h4 id="threads">Threads</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> nº de hilos usados por Kraken2 para procesar lecturas en paralelo.</p>
    </li>
    <li>
        <p><strong>Efecto:</strong> incrementa velocidad hasta límites CPU/IO.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> usar cercano al número de núcleos disponibles (ej. 4–32). Si compartes
            recursos, elige un valor menor.</p>
    </li>
</ul>
<h4 id="quick">Quick</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> modo rápido donde Kraken2 puede aceptar una asignación y pasar a la siguiente
            lectura antes de procesar exhaustivamente todas las k-mers.</p>
    </li>
    <li>
        <p><strong>Efecto:</strong> menor tiempo de ejecución y CPU; posible reducción de información por read.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> usar para análisis exploratorios o cuando necesites rapidez; desactivar para
            máxima exhaustividad.</p>
    </li>
</ul>
<h4 id="memory-mapping">Memory mapping</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> usar <em>mmap</em> para acceder a la DB en disco en lugar de cargarla completa en
            RAM.</p>
    </li>
    <li>
        <p><strong>Efecto:</strong> reduce consumo pico de RAM, aumenta I/O desde disco; performance depende del disco
            (SSD mejor).</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> activar si tienes RAM limitada y disco rápido; si tienes mucha RAM,
            desactivar para mayor velocidad.</p>
    </li>
</ul>
<h4 id="confidence">Confidence</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> umbral (0–1) que Kraken2 usa para aceptar una asignación (fracción de k-mers que
            deben respaldarla).</p>
    </li>
    <li>
        <p><strong>Efecto:</strong> valores altos → asignaciones más conservadoras (menos falsos positivos, más no
            clasificadas). Valores bajos → más lecturas clasificadas con mayor riesgo de falsos positivos.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> probar varios valores (p. ej. 0.0, 0.1, 0.2, 0.5) en un subconjunto para
            calibrar precisión/recall según tu objetivo.</p>
    </li>
</ul>
<h4 id="minimum-hit-groups">Minimum hit groups</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> nº mínimo de <em>hit groups</em> (grupos de minimizers coincidentes) requeridos
            para aceptar clasificación.</p>
    </li>
    <li>
        <p><strong>Efecto:</strong> aumenta la estricticidad de la llamada si el número sube.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> <code>1–3</code> para uso estándar; subir si la muestra es muy compleja o si
            quieres reducir falsos positivos.</p>
    </li>
</ul>
<h4 id="minimum-base-quality">Minimum base quality</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> umbral de calidad mínima de base para incluir una base en la formación de k-mers
            (bases por debajo se ignoran).</p>
    </li>
    <li>
        <p><strong>Efecto:</strong> reduce ruido de k-mers derivados de bases pobres.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> si las lecturas tienen calidades bajas, coloca un umbral razonable (ej.
            10–20) o limpia antes con Trimmomatic; si los datos están limpios, <code>0</code> acepta todo.</p>
    </li>
</ul>
<hr>
<h3 id="consejos-pr-cticos">Consejos prácticos</h3>
<ul>
    <li>Si tienes RAM limitada:** activa <code>memory mapping</code> y preferiblemente usa SSD.</li>
    <li><strong>Elije DB con cuidado:</strong> DB grandes (RefSeq completo) dan mayor cobertura pero requieren más
        recursos; DB reducidas son más rápidas y menos ruidosas.</li>
</ul>