<h4 id="3-2-3-sortmerna-panel-de-filtrado-de-rrna">3.2.3 SortMeRNA — Panel de filtrado de rRNA</h4>
<h3 id="-qu-es-este-panel-">¿Qué es este panel?</h3>
<p>El módulo <strong>SortMeRNA</strong> permite identificar y filtrar lecturas de ARN ribosomal (rRNA) en archivos
    FASTQ. El objetivo típico es separar las lecturas rRNA de las no-rRNA para obtener un conjunto limpio
    (<em>non-rRNA</em>) que se use en análisis posteriores (por ejemplo Kraken2). Desde este panel se selecciona el
    archivo de entrada y la base de datos de referencia, se ajustan los parámetros de alineamiento, se ejecuta el
    filtrado y se gestionan las bases de datos y las configuraciones guardadas. También es posible ver la línea de
    comando exacta que se ejecuta para reproducibilidad.</p>
<hr>
<h3 id="vista-general-del-panel">Vista general del panel</h3>
<p>Componentes clave que verás en el panel:</p>
<ul>
    <li>
        <p><strong>Selector de archivo</strong> — control para elegir el FASTQ de entrada.</p>
    </li>
    <li>
        <p><strong>Selector de base de datos</strong> — menú para seleccionar la DB de referencia.</p>
    </li>
    <li>
        <p><strong>Botón/ventana Gestor de bases de datos</strong> — abre un modal para descargar DB disponibles.</p>
    </li>
    <li>
        <p><strong>Botones superiores (derecha)</strong>:</p>
        <ol>
            <li>
                <p><strong>Guardar configuración</strong> (estrella) — guarda los parámetros actuales.</p>
            </li>
            <li>
                <p><strong>Ver comando</strong> — abre una modal con la invocación <code>sortmerna ...</code> que se
                    ejecutará.</p>
            </li>
            <li>
                <p><strong>Manual</strong> — abre la sección de ayuda de SortMeRNA en la Ventana de Ayuda.</p>
            </li>
            <li>
                <p><strong>Gestor de bases de datos</strong> (si corresponde, ícono adicional).</p>
            </li>
        </ol>
    </li>
    <li>
        <p><strong>Panel de reportes / resultados anteriores</strong> — lista de salidas previas (accesos: abrir
            carpeta, eliminar).</p>
    </li>
    <li>
        <p><strong>Página de opciones</strong> — controles para Threads, formato BLAST, número de alineamientos,
            longitud mínima, escritura de lecturas no alineadas, generar SAM, etiquetas SQ, reportar sólo mejor hit o
            múltiples, y manejo paired-end.</p>
    </li>
    <li>
        <p><strong>Botones de acción</strong> — <strong>Atrás</strong> y <strong>Ejecutar / Filtrar</strong>.</p>
    </li>
</ul>
<hr>
<h3 id="ejemplos-visuales">Ejemplos visuales</h3>
<p><strong>Figura — Selector de archivo y base de datos (Página
        1).</strong></p>
<br>
<img src=":/manual/main_window_sortmerna_panel_files_page.png" alt="" width="500">
<br>
<p><em>Selector de archivo y menú para elegir la base de datos de referencia.</em>
</p>
<p><strong>Figura — Gestor de bases de datos (modal).</strong></p>
<br>
<img src=":/manual/main_window_sortmerna_panel_database.png" alt="" width="500">
<br>
<p><em>Ventana emergente para descargar bases de datos de referencia.</em>
</p>
<p><strong>Figura — Página de opciones (Página 2).</strong></p>
<br>
<img src=":/manual/main_window_sortmerna_panel_options_page.png" alt="" width="500">
<br>
<p><em>Controles configurables: Threads, formato BLAST, número de alineamientos, minlen, salida non-rRNA, SAM,
        etiquetas, do-not-best, paired-end.</em>
</p>
<p><strong>Figura — Modal “Ver comando”.</strong></p>
<br>
<img src=":/manual/main_window_sortmerna_panel_command.png" alt="" width="500">
<br>
<p><em>Modal que muestra la línea de comando <code>sortmerna</code> que se ejecutará con los parámetros
        seleccionados.</em>
</p>
<hr>
<h3 id="flujo-de-uso-paso-a-paso-">Flujo de uso (paso a paso)</h3>
<ol>
    <li>
        <p><strong>Seleccionar archivo</strong>: elija el FASTQ de entrada desde el control de selector.</p>
    </li>
    <li>
        <p><strong>Elegir base de datos</strong>: seleccione la DB de referencia desde el selector; si la DB no está
            disponible, abra el <strong>Gestor de bases de datos</strong> y descárguela.</p>
    </li>
    <li>
        <p><strong>Siguiente → Opciones</strong>: abra la página de parámetros y ajuste los valores (Threads, formato
            BLAST, número de alineamientos, minlen, etc.).</p>
    </li>
    <li>
        <p><strong>(Opcional) Ver comando</strong>: abra la modal para ver/copiar la línea <code>sortmerna</code> que
            se ejecutará (útil para reproducibilidad).</p>
    </li>
    <li>
        <p><strong>Ejecutar / Filtrar</strong>: inicie SortMeRNA; la ejecución muestra progreso y, al finalizar, genera
            archivos con lecturas alineadas (rRNA), no alineadas (non-rRNA) y, si se solicita, un SAM con los
            alineamientos.</p>
    </li>
    <li>
        <p><strong>Revisar salidas</strong>: las salidas aparecen en el panel de inicio o en la primera página de este
            panel en la lista de reportes anteriores.</p>
    </li>
</ol>
<h3 id="opciones-descripci-n-detallada-y-recomendaciones">Opciones — descripción detallada y recomendaciones</h3>
<blockquote>
    <p>Para cada opción se indica qué hace y recomendaciones prácticas.</p>
</blockquote>
<h4 id="threads">Threads</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> nº de hilos para paralelizar búsquedas/alineamientos.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> ajustar al nº de núcleos disponibles (ej. 4–16). Menos hilos si la máquina
            tiene poca RAM.</p>
    </li>
</ul>
<h4 id="formato-de-salida-blast-blast-output-format-">Formato de salida BLAST (blast output format)</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> determina el formato usado para la salida tipo BLAST (si se solicita).</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> use formato tabular (<code>outfmt 6</code>) para parsing automático;
            formatos más completos si necesita información detallada.</p>
    </li>
</ul>
<h4 id="n-mero-de-alineamientos">Número de alineamientos</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> nº máximo de hits a reportar por lectura.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> <code>1</code> para solo el mejor hit (compacto y simple); aumente (5–10)
            para estudiar multi-mappings si necesita ese detalle.</p>
    </li>
</ul>
<h4 id="longitud-m-nima-de-secuencia-minimum-sequence-length-">Longitud mínima de secuencia (minimum sequence length)
</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> descarta lecturas más cortas que este umbral de la consideración/alineamiento.
        </p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> para lecturas de ~150 bp usar <code>30–50</code>; no fijar un umbral tan
            alto que pierda lecturas útiles.</p>
    </li>
</ul>
<h4 id="salida-de-lecturas-no-alineadas-output-unaligned-keep-unaligned-">Salida de lecturas no alineadas (output
    unaligned / keep unaligned)</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> guarda las lecturas que <strong>no</strong> alinean contra rRNA en un archivo
            separado (non-rRNA).</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> activar siempre si el resultado se usará en etapas posteriores.</p>
    </li>
</ul>
<h4 id="archivo-de-alineaci-n-sam-write-sam-">Archivo de alineación SAM (write SAM)</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> genera archivo SAM con alineamientos detallados.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> habilitar solo para inspección/debug; los SAM suelen ser grandes.</p>
    </li>
</ul>
<h4 id="etiquetas-adicionales-sq-en-sam-add-sq-tags-">Etiquetas adicionales <code>sq</code> en SAM (add sq tags)</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> añade etiquetas extras en las entradas SAM para metadatos.</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> activar solo si downstream lo requiere.</p>
    </li>
</ul>
<h4 id="no-mostrar-el-mejor-alineamiento-do-not-report-best-hit-only-">No mostrar el mejor alineamiento (do not
    report best hit only)</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> al marcarlo, SortMeRNA reporta múltiples hits por lectura (hasta el valor
            definido).</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> dejar desmarcado por defecto (solo el mejor hit) salvo que se investigue
            multi-mapping.</p>
    </li>
</ul>
<h4 id="lecturas-paired-end-paired-end-handling-">Lecturas paired-end (paired-end handling)</h4>
<ul>
    <li>
        <p><strong>Qué hace:</strong> procesa y mantiene la relación de mates; genera salidas acordes a pares
            (paired/unpaired).</p>
    </li>
    <li>
        <p><strong>Recomendación:</strong> activar para datos PE y verificar que ambos mates estén bien seleccionados.
        </p>
    </li>
</ul>
<hr>
<h3 id="mensajes-y-errores-qu-esperar-">Mensajes y errores (qué esperar)</h3>
<ul>
    <li>
        <p><strong>DB no encontrada:</strong> la ejecución aborta; abra el Gestor de DB y descargue la base requerida.
        </p>
    </li>
    <li>
        <p><strong>Memoria insuficiente:</strong> DB grandes requieren RAM; si falla por memoria, reduzca threads o use
            otra DB.</p>
    </li>
    <li>
        <p><strong>Formato/archivo inválido:</strong> lectura corrupta o formato no soportado provocará fallo; valide
            el FASTQ.</p>
    </li>
    <li>
        <p><strong>Errores PE:</strong> mates desajustados (número/nombres) pueden generar warnings o singletons;
            verificar pares antes de ejecutar.</p>
    </li>
</ul>
<h3 id="consejos-pr-cticos">Consejos prácticos</h3>
<ul>
    <li>
        <p><strong>Orden recomendado en pipeline:</strong> FastQC → Trimmomatic → SortMeRNA → Kraken2.</p>
    </li>
    <li>
        <p><strong>Siempre guarde las non-rRNA</strong> para análisis posteriores.</p>
    </li>
    <li>
        <p><strong>Descargue solo las DB necesarias</strong> para ahorrar espacio y tiempo.</p>
    </li>
    <li>
        <p><strong>Documente la ejecución</strong> copiando la línea de <strong>Ver comando</strong>.</p>
    </li>
    <li>
        <p><strong>Verifique recursos</strong> (RAM/espacio) antes de ejecutar DB grandes.</p>
    </li>
</ul>